
CREATE TABLE restaurants (
    id INTEGER PRIMARY KEY,
    name VARCHAR(30),
    address VARCHAR(100),
    contact_phone VARCHAR(30)
);

CREATE TABLE clients (
    id INTEGER PRIMARY KEY,
    f_name VARCHAR(30),
    l_name VARCHAR(30),
    phone VARCHAR(30),
    address VARCHAR(100)
);

CREATE TABLE couriers (
    id INTEGER PRIMARY KEY,
    f_name VARCHAR(30),
    l_name VARCHAR(30),
    phone INTEGER
);

CREATE TABLE menu (
    dish_id INTEGER PRIMARY KEY,
    restaurant_id INTEGER NOT NULL,
    name VARCHAR(30),
    weight INTEGER,
    price DECIMAL
);

CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY,
    client_id INTEGER NOT NULL,
    courier_id INTEGER NOT NULL,
    order_time DATETIME,
    total_amount DECIMAL,
    status_id INTEGER NOT NULL,
    comment TEXT
);

CREATE TABLE order_items (
    order_id INTEGER NOT NULL,
    dish_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL DEFAULT 1,
    price_at_time DECIMAL NOT NULL,
    PRIMARY KEY (order_id, dish_id)
);

CREATE TABLE status (
    id INTEGER PRIMARY KEY,
    status VARCHAR(30)
);

---------------------------------------------

ALTER TABLE menu 
ADD CONSTRAINT fk_menu_restaurant 
FOREIGN KEY (restaurant_id) REFERENCES restaurants(id);

ALTER TABLE orders 
ADD CONSTRAINT fk_orders_client 
FOREIGN KEY (client_id) REFERENCES clients(id);

ALTER TABLE orders 
ADD CONSTRAINT fk_orders_courier 
FOREIGN KEY (courier_id) REFERENCES couriers(id);

ALTER TABLE orders 
ADD CONSTRAINT fk_orders_status 
FOREIGN KEY (status_id) REFERENCES status(id);

ALTER TABLE order_items 
ADD CONSTRAINT fk_order_items_order 
FOREIGN KEY (order_id) REFERENCES orders(order_id);

ALTER TABLE order_items 
ADD CONSTRAINT fk_order_items_dish 
FOREIGN KEY (dish_id) REFERENCES menu(dish_id);